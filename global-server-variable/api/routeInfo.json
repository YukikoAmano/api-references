{"path":"global-server-variable/api","templateID":1,"sharedPropsHashes":{"apiList":"ZBJJOF"},"localProps":{"reference":{"title":"グローバルサーバー変数APIを利用する","slug":"global-server-variable/api","description":"RPGアツマール ゲームAPIを使ったグローバルサーバー変数の利用方法について解説します。","order":3,"experimental":true,"contents":"<p>APIを使ったグローバルサーバー変数の利用方法について解説します。予め、<a href=\"/global-server-variable/setting\">グローバルサーバー変数設定画面</a>で変数及びトリガーの設定を済ませておく必要があります。</p>\n<h2 id=\"-\">グローバルサーバー変数取得</h2>\n<p>グローバルサーバー変数のIDを指定し、現在値、最大値、最小値、変数名を取得します。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.experimental.globalServerVariable.getGlobalServerVariable(globalServerVariableId: number)</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">引数に指定した globalServerVariableId のグローバルサーバー変数の情報を取得する</td>\n</tr>\n<tr>\n<td align=\"left\">引数</td>\n<td align=\"left\">グローバルサーバー変数ID (自然数) ※<a href=\"/global-server-variable/setting\">グローバルサーバー変数設定画面</a>で設定</td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;GlobalServerVariableData&gt;</code></td>\n</tr>\n<tr>\n<td align=\"left\">リリース日</td>\n<td align=\"left\">2018/12/17</td>\n</tr>\n<tr>\n<td align=\"left\">更新日</td>\n<td align=\"left\">2019/06/17</td>\n</tr>\n</tbody></table>\n<h3 id=\"-globalservervariabledata-\">戻り値の型 GlobalServerVariableData について</h3>\n<p>戻り値で取得できる <code>GlobalServerVariableData</code> は以下のような型です。</p>\n<pre><code class=\"language-js\">interface GlobalServerVariableData {\n  name: string,\n  maxValue: number,\n  minValue: number,\n  value: number | string,\n}</code></pre>\n<p>プロパティの内容は次のようになっています。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">プロパティ名</th>\n<th align=\"left\">型</th>\n<th align=\"left\">内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">value</td>\n<td align=\"left\"><code>number &amp;#124 string</code></td>\n<td align=\"left\">グローバルサーバー変数の現在値</td>\n</tr>\n<tr>\n<td align=\"left\">minValue</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">グローバルサーバー変数の最小値(変数が文字列型の場合は常に0になります)</td>\n</tr>\n<tr>\n<td align=\"left\">maxValue</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">グローバルサーバー変数の最大値(変数が文字列型の場合は常に0になります)</td>\n</tr>\n<tr>\n<td align=\"left\">name</td>\n<td align=\"left\"><code>string</code></td>\n<td align=\"left\">グローバルサーバー変数の変数名</td>\n</tr>\n</tbody></table>\n<h3 id=\"-\">戻り値の例</h3>\n<pre><code class=\"language-js\">// window.RPGAtsumaru.experimental.globalServerVariable.getGlobalServerVariable(1).then(function(v) { console.log(v) }) を実行\n{\n  &quot;name&quot;: &quot;レイドボスHP&quot;,\n  &quot;maxValue&quot;: 10000,\n  &quot;minValue&quot;: 0,\n  &quot;value&quot;: 1234\n}</code></pre>\n<h3 id=\"-\">起こりうるエラーの種類</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">BAD_REQUEST</a></td>\n<td align=\"left\"><ul><li>指定したグローバルサーバー変数IDがそのゲームのものではない</li><li>引数として不正な値を指定している</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にRPGアツマール ゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n<h2 id=\"-\">グローバルサーバー変数取得(名前指定型)</h2>\n<p>グローバルサーバー変数の変数名を指定し、現在値、最大値、最小値、変数名を取得します。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.experimental.globalServerVariable.getGlobalServerVariableByName(globalServerVariableName: string)</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">引数に指定した globalServerVariableName のグローバルサーバー変数の情報を取得する</td>\n</tr>\n<tr>\n<td align=\"left\">引数</td>\n<td align=\"left\">グローバルサーバー変数名 (文字列) ※<a href=\"/global-server-variable/setting\">グローバルサーバー変数設定画面</a>で設定</td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;GlobalServerVariableData&gt;</code></td>\n</tr>\n<tr>\n<td align=\"left\">リリース日</td>\n<td align=\"left\">2019/06/17</td>\n</tr>\n<tr>\n<td align=\"left\">更新日</td>\n<td align=\"left\">2019/06/17</td>\n</tr>\n</tbody></table>\n<h3 id=\"-globalservervariabledata-\">戻り値の型 GlobalServerVariableData について</h3>\n<p>戻り値で取得できる <code>GlobalServerVariableData</code> は以下のような型です。</p>\n<pre><code class=\"language-js\">interface GlobalServerVariableData {\n  name: string,\n  maxValue: number,\n  minValue: number,\n  value: number | string,\n}</code></pre>\n<p>プロパティの内容は次のようになっています。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">プロパティ名</th>\n<th align=\"left\">型</th>\n<th align=\"left\">内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">value</td>\n<td align=\"left\"><code>number &amp;#124 string</code></td>\n<td align=\"left\">グローバルサーバー変数の現在値</td>\n</tr>\n<tr>\n<td align=\"left\">minValue</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">グローバルサーバー変数の最小値(変数が文字列型の場合は常に0になります)</td>\n</tr>\n<tr>\n<td align=\"left\">maxValue</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">グローバルサーバー変数の最大値(変数が文字列型の場合は常に0になります)</td>\n</tr>\n<tr>\n<td align=\"left\">name</td>\n<td align=\"left\"><code>string</code></td>\n<td align=\"left\">グローバルサーバー変数の変数名</td>\n</tr>\n</tbody></table>\n<h3 id=\"-\">戻り値の例</h3>\n<pre><code class=\"language-js\">// window.RPGAtsumaru.experimental.globalServerVariable.getGlobalServerVariableByName(&quot;変数1&quot;).then(function(v) { console.log(v) }) を実行\n{\n  &quot;name&quot;: &quot;変数1&quot;,\n  &quot;maxValue&quot;: 0,\n  &quot;minValue&quot;: 0,\n  &quot;value&quot;: &quot;ハロルド&quot;\n}</code></pre>\n<h3 id=\"-\">起こりうるエラーの種類</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">BAD_REQUEST</a></td>\n<td align=\"left\"><ul><li>指定したグローバルサーバー変数名が見つからない</li><li>指定したグローバルサーバー変数名が複数存在する</li><li>引数として不正な値を指定している</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にRPGアツマール ゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n<h2 id=\"-\">トリガー発動</h2>\n<p>予め設定したトリガーIDを指定して、グローバルサーバー変数の値を変化させます。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.experimental.globalServerVariable.triggerCall(triggerId: number, value?: number &amp;#124 string)</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">引数に指定したtriggeridのトリガーを発動させる</td>\n</tr>\n<tr>\n<td align=\"left\">引数</td>\n<td align=\"left\"><ul><li><code>triggerId</code>: トリガーID (自然数) ※<a href=\"/global-server-variable/setting\">グローバルサーバー変数設定画面</a>で設定</li><li><code>value</code>: 変数を増減させる値/変数に設定する値 (「最大値・最小値の範囲で増減」トリガーと「値を代入」の場合のみ指定可能)</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;void&gt;</code></td>\n</tr>\n<tr>\n<td align=\"left\">リリース日</td>\n<td align=\"left\">2018/12/17</td>\n</tr>\n<tr>\n<td align=\"left\">更新日</td>\n<td align=\"left\">2019/06/17</td>\n</tr>\n</tbody></table>\n<ul>\n<li>引数 <code>value</code> はトリガーの種別が「最大値・最小値の範囲で増減」「値を代入」のときのみ指定可能です。\n-「固定値を増減」トリガーの場合は指定しないでください。</li>\n</ul>\n<h3 id=\"-\">トリガーの呼び出し例</h3>\n<pre><code class=\"language-js\">// 1番トリガーの実行(1番トリガーはvalueが不要なトリガー)\nwindow.RPGAtsumaru.experimental.globalServerVariable.triggerCall(1)\n  .then(function() { /* 後続処理 */ })\n// 2番トリガーの実行を実行して、変数の値に777加算する(2番トリガーは数値変数に付いた「ゲーム内で増減値を指定して実行」トリガー)\nwindow.RPGAtsumaru.experimental.globalServerVariable.triggerCall(2, 777)\n  .then(function() { /* 後続処理 */ })\n// 3番トリガーの実行を実行して、変数に「ぬるぽ」という文字列を代入する(3番トリガーは文字変数に付いた「ゲーム内で設定値を指定して実行」トリガー)\nwindow.RPGAtsumaru.experimental.globalServerVariable.triggerCall(3, &quot;ぬるぽ&quot;)\n  .then(function() { /* 後続処理 */ })</code></pre>\n<h3 id=\"-\">起こりうるエラーの種類</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">BAD_REQUEST</a></td>\n<td align=\"left\"><ul><li>指定したトリガーIDがそのゲームのものではない</li><li>「固定値を増減」トリガーで <code>value</code> を指定した</li><li>「最大値・最小値の範囲で増減」トリガーで <code>value</code> を省略した</li><li>引数として不正な値を指定している</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n<h2 id=\"-\">トリガー発動(名前指定型)</h2>\n<p>予め設定した変数名とトリガー名を指定して、グローバルサーバー変数の値を変化させます。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.experimental.globalServerVariable.triggerCallByName(globalServerVariableName:string, triggerName: string, value?: number &amp;#124 string)</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">引数に指定した変数名とトリガー名のトリガーを発動させる</td>\n</tr>\n<tr>\n<td align=\"left\">引数</td>\n<td align=\"left\"><ul><li><code>globalServerVariableName</code>: グローバルサーバ変数名 ※<a href=\"/global-server-variable/setting\">グローバルサーバー変数設定画面</a>で設定</li><li><code>triggerName</code>: トリガー名 ※<a href=\"/global-server-variable/setting\">グローバルサーバー変数設定画面</a>で設定</li><li><code>value</code>: 変数を増減させる値/変数に設定する値 (「最大値・最小値の範囲で増減」トリガーと「値を代入」の場合のみ指定可能)</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;void&gt;</code></td>\n</tr>\n<tr>\n<td align=\"left\">リリース日</td>\n<td align=\"left\">2019/06/17</td>\n</tr>\n<tr>\n<td align=\"left\">更新日</td>\n<td align=\"left\">2019/06/17</td>\n</tr>\n</tbody></table>\n<ul>\n<li>引数 <code>value</code> はトリガーの種別が「最大値・最小値の範囲で増減」「値を代入」のときのみ指定可能です。\n-「固定値を増減」トリガーの場合は指定しないでください。</li>\n</ul>\n<h3 id=\"-\">トリガーの呼び出し例</h3>\n<pre><code class=\"language-js\">// 1番トリガーの実行(1番トリガーはvalueが不要なトリガー)\nwindow.RPGAtsumaru.experimental.globalServerVariable.triggerCallByName(&quot;数値変数1&quot;, &quot;増減値指定済み1&quot;)\n  .then(function() { /* 後続処理 */ })\n// 2番トリガーの実行を実行して、変数の値に777加算する(2番トリガーは数値変数に付いた「最大値・最小値の範囲で増減」トリガー\nwindow.RPGAtsumaru.experimental.globalServerVariable.triggerCallByName(&quot;数値変数2&quot;, &quot;可算トリガー1&quot;, 777)\n  .then(function() { /* 後続処理 */ })\n// 3番トリガーの実行を実行して、変数に「ぬるぽ」という文字列を代入する(3番トリガーは文字変数に付いた「値を代入」トリガー)\nwindow.RPGAtsumaru.experimental.globalServerVariable.triggerCallByName(&quot;文字列変数1&quot;, &quot;代入トリガー1&quot;, &quot;ぬるぽ&quot;)\n  .then(function() { /* 後続処理 */ })</code></pre>\n<h3 id=\"-\">起こりうるエラーの種類</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">BAD_REQUEST</a></td>\n<td align=\"left\"><ul><li>指定したグローバルサーバ変数名が見当たらないか複数存在</li><li>指定したトリガー名が見当たらないか複数存在</li><li>「固定値を増減」トリガーで <code>value</code> を指定した</li><li>「最大値・最小値の範囲で増減」トリガーで <code>value</code> を省略した</li><li>引数として不正な値を指定している</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n<h2 id=\"-\">グローバルサーバー変数一括取得</h2>\n<p>ゲームに定義されているグローバルサーバー変数とトリガーの情報をすべて取得します。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">メソッド</th>\n<th align=\"left\"><code>window.RPGAtsumaru.experimental.globalServerVariable.getAllGlobalServerVariables()</code></th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">説明</td>\n<td align=\"left\">グローバルサーバー変数とトリガーの情報をすべて取得する</td>\n</tr>\n<tr>\n<td align=\"left\">戻り値</td>\n<td align=\"left\"><code>Promise&lt;GlobalServerVariableDefinition[]&gt;</code></td>\n</tr>\n<tr>\n<td align=\"left\">リリース日</td>\n<td align=\"left\">2019/3/5</td>\n</tr>\n<tr>\n<td align=\"left\">更新日</td>\n<td align=\"left\">2019/3/5</td>\n</tr>\n</tbody></table>\n<h3 id=\"-globalservervariabledefinition-\">戻り値の型 GlobalServerVariableDefinition について</h3>\n<p>戻り値で取得できる <code>GlobalServerVariableDefinition</code> は以下のような型です。</p>\n<pre><code class=\"language-js\">interface GlobalServerVariableDefinition {\n  globalServerVariableId: number,\n  name: string,\n  maxValue: number,\n  minValue: number,\n  value: number | string,\n  triggers: GlobalServerVariableTrigger[]\n}\n\ninterface GlobalServerVariableTrigger {\n    triggerId: number;\n    triggerType: string;\n    triggerName: string | null;\n    memo: string | null;\n    argument1: string | null;\n    argument2: string | null;\n    argument3: string | null;\n    argument4: string | null;\n    argument5: string | null;\n}</code></pre>\n<p>プロパティの内容は次のようになっています。</p>\n<table>\n<thead>\n<tr>\n<th align=\"left\">プロパティ名</th>\n<th align=\"left\">型</th>\n<th align=\"left\">内容</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\">globalServerVariableId</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">グローバルサーバー変数ID</td>\n</tr>\n<tr>\n<td align=\"left\">value</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">グローバルサーバー変数の現在値</td>\n</tr>\n<tr>\n<td align=\"left\">minValue</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">グローバルサーバー変数の最小値</td>\n</tr>\n<tr>\n<td align=\"left\">maxValue</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">グローバルサーバー変数の最大値</td>\n</tr>\n<tr>\n<td align=\"left\">name</td>\n<td align=\"left\"><code>string</code></td>\n<td align=\"left\">グローバルサーバー変数の変数名</td>\n</tr>\n<tr>\n<td align=\"left\">triggers</td>\n<td align=\"left\"><code>GlobalServerVariableTrigger[]</code></td>\n<td align=\"left\">トリガー一覧</td>\n</tr>\n<tr>\n<td align=\"left\">triggerId</td>\n<td align=\"left\"><code>number</code></td>\n<td align=\"left\">トリガーID</td>\n</tr>\n<tr>\n<td align=\"left\">triggerType</td>\n<td align=\"left\"><code>string</code></td>\n<td align=\"left\">トリガー種別 <ul><li><code>callableByGames</code>: 固定値を増減</li><li><code>specifiedValue</code>: 最大値・最小値の範囲で増減</li><li><code>setValue</code>: 値を代入</li></ul></td>\n</tr>\n<tr>\n<td align=\"left\">triggerName</td>\n<td align=\"left\"><code>string &amp;#124; null</code></td>\n<td align=\"left\">トリガー名</td>\n</tr>\n<tr>\n<td align=\"left\">memo</td>\n<td align=\"left\"><code>string &amp;#124; null</code></td>\n<td align=\"left\">トリガー管理用メモ</td>\n</tr>\n<tr>\n<td align=\"left\">argument1~5</td>\n<td align=\"left\"><code>string &amp;#124; null</code></td>\n<td align=\"left\">トリガー種別ごとに異なる値が入ります <ul><li>固定値を増減: <ul><li><code>argument1</code>: 差分</li></ul></li><li>最大値・最小値の範囲で増減: <ul><li><code>argument1</code>: 差分の最小値</li><li><code>argument2</code>: 差分の最大値</li></ul></li></ul></td>\n</tr>\n</tbody></table>\n<h3 id=\"-\">戻り値の例</h3>\n<pre><code class=\"language-js\">// window.RPGAtsumaru.experimental.globalServerVariable.getAllGlobalServerVariables().then(function(v) { console.log(v) }) を実行\n[\n  {\n    &quot;name&quot;: &quot;スコア&quot;,\n    &quot;maxValue&quot;: 100000,\n    &quot;minValue&quot;: 0,\n    &quot;value&quot;: 41,\n    &quot;globalServerVariableId&quot;: 2,\n    &quot;triggers&quot;: [\n      {\n        &quot;triggerType&quot;: &quot;callableByGames&quot;,\n        &quot;memo&quot;: &quot;スコアアップ&quot;,\n        &quot;triggerName&quot;: &quot;スコアアップ&quot;\n        &quot;argument1&quot;: &quot;1&quot;,\n        &quot;argument2&quot;: null,\n        &quot;argument3&quot;: null,\n        &quot;argument4&quot;: null,\n        &quot;argument5&quot;: null,\n        &quot;triggerId&quot;: 1\n      },\n      {\n        &quot;triggerType&quot;: &quot;specifiedValue&quot;,\n        &quot;memo&quot;: &quot;ボーナス&quot;,\n        &quot;triggerName&quot;: &quot;&quot;,\n        &quot;argument1&quot;: &quot;5&quot;,\n        &quot;argument2&quot;: &quot;50&quot;,\n        &quot;argument3&quot;: null,\n        &quot;argument4&quot;: null,\n        &quot;argument5&quot;: null,\n        &quot;triggerId&quot;: 12\n      }\n    ]\n  }\n]</code></pre>\n<h3 id=\"-\">起こりうるエラーの種類</h3>\n<table>\n<thead>\n<tr>\n<th align=\"left\">名前</th>\n<th align=\"left\">説明</th>\n</tr>\n</thead>\n<tbody><tr>\n<td align=\"left\"><a href=\"/common/errors\">INTERNAL_SERVER_ERROR</a></td>\n<td align=\"left\">RPGアツマールのサービス側で何らかの問題が発生しているか、または通信に失敗した</td>\n</tr>\n<tr>\n<td align=\"left\"><a href=\"/common/errors\">API_CALL_LIMIT_EXCEEDED</a></td>\n<td align=\"left\">短時間にRPGアツマール ゲームAPIを利用しすぎて、一時的に利用を制限されている</td>\n</tr>\n</tbody></table>\n"},"title":"グローバルサーバー変数APIを利用する","path":"/global-server-variable/api"}}
